/*! Lity - v3.0.0-dev - 2018-07-09
* http://sorgalla.com/lity/
* Copyright (c) 2015-2018 Jan Sorgalla; Licensed MIT */
!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],(function($){return t(e,$)})):"object"==typeof module&&"object"==typeof module.exports?module.exports=t(e,require("jquery")):e.lity=t(e,e.jQuery||e.Zepto)}("undefined"!=typeof window?window:this,(function(e,$){"use strict";var t=e.document,n=$(e),i=$.Deferred,r=$("html"),a=[],o="aria-hidden",l="lity-aria-hidden",s='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])',d={esc:!0,handler:null,handlers:{image:m,inline:function(e,t){var n,i,r;try{n=$(e)}catch(e){return!1}if(!n.length)return!1;return i=$('<i style="display:none !important"/>'),r=n.hasClass("lity-hide"),t.element().one("lity:remove",(function(){i.before(n).remove(),r&&!n.closest(".lity-content").length&&n.addClass("lity-hide")})),n.removeClass("lity-hide").after(i)},iframe:function(e,t){return h(e,t)}},template:'<div class="lity" role="dialog" aria-label="Dialog Window (Press escape to close)" tabindex="-1"><div class="lity-wrap" data-lity-close role="document"><div class="lity-loader" aria-hidden="true">Loading...</div><div class="lity-container"><div class="lity-content"></div><button class="lity-close" type="button" aria-label="Close (Press escape to close)" data-lity-close>&times;</button></div></div></div>'},c=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i,u=function(){var e=t.createElement("div"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in n)if(void 0!==e.style[i])return n[i];return!1}();function f(e){var t=i();return u&&e.length?(e.one(u,t.resolve),setTimeout(t.resolve,500)):t.resolve(),t.promise()}function y(e,t,n){if(1===arguments.length)return $.extend({},e);if("string"==typeof t){if(void 0===n)return void 0===e[t]?null:e[t];e[t]=n}else $.extend(e,t);return this}function v(e){var t=e.indexOf("?");t>-1&&(e=e.substr(t+1));for(var n,i=decodeURI(e.split("#")[0]).split("&"),r={},a=0,o=i.length;a<o;a++)i[a]&&(r[(n=i[a].split("="))[0]]=n[1]);return r}function h(e,t,n,i){var r,a,o;return t&&t.element().addClass("lity-iframe"),n&&(e=function(e,t){if(!t)return e;if("string"===$.type(t)&&(t=v(t)),e.indexOf("?")>-1){var n=e.split("?");e=n.shift(),t=$.extend({},v(n[0]),t)}return e+"?"+$.param(t)}(e,n)),i&&(a=e,e=-1===(o=(r=i).indexOf("#"))?a:(o>0&&(r=r.substr(o)),a+r)),'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+e+'"/></div>'}function m(e,t){var n=t.opener()&&t.opener().data("lity-desc")||"Image with no description",r=$('<img src="'+e+'" alt="'+n+'"/>'),a=i(),o=function(){var e;a.reject((e="Failed loading image",$('<span class="lity-error"/>').append(e)))};return r.on("load",(function(){if(0===this.naturalWidth)return o();a.resolve(r)})).on("error",o),a.promise()}function p(){return t.documentElement.clientHeight?t.documentElement.clientHeight:Math.round(n.height())}function g(e){var n=x();n&&(27===e.keyCode&&n.options("esc")&&n.close(),9===e.keyCode&&function(e,n){var i=n.element().find(s),r=i.index(t.activeElement);e.shiftKey&&r<=0?(i.get(i.length-1).focus(),e.preventDefault()):e.shiftKey||r!==i.length-1||(i.get(0).focus(),e.preventDefault())}(e,n))}function b(){$.each(a,(function(e,t){t.resize()}))}function x(){return 0===a.length?null:a[0]}function w(e,s,c,u){var v,h,m,x,w=this,C=!1,E=!1;s=$.extend({},d,s),h=$(s.template),w.element=function(){return h},w.opener=function(){return c},w.content=function(){return m},w.options=$.proxy(y,w,s),w.handlers=$.proxy(y,w,s.handlers),w.resize=function(){C&&!E&&m.css("max-height",p()+"px").trigger("lity:resize",[w])},w.close=function(){if(C&&!E){var e;E=!0,(e=w).element().attr(o,"true"),1===a.length&&(r.removeClass("lity-active"),n.off({resize:b,keydown:g})),((a=$.grep(a,(function(t){return e!==t}))).length?a[0].element():$(".lity-hidden")).removeClass("lity-hidden").each((function(){var e=$(this),t=e.data(l);t?e.attr(o,t):e.removeAttr(o),e.removeData(l)}));var s=i();if(u&&(t.activeElement===h[0]||$.contains(h[0],t.activeElement)))try{u.focus()}catch(e){}return m.trigger("lity:close",[w]),h.removeClass("lity-opened").addClass("lity-closed"),f(m.add(h)).always((function(){m.trigger("lity:remove",[w]),h.remove(),h=void 0,s.resolve()})),s.promise()}},v=function(e,t,n,i){var r,a="inline",o=$.extend({},n);return i&&o[i]?(r=o[i](e,t),a=i):($.each(["inline","iframe"],(function(e,t){delete o[t],o[t]=n[t]})),$.each(o,(function(n,i){return!i||!(!i.test||i.test(e,t))||(!1!==(r=i(e,t))?(a=n,!1):void 0)}))),{handler:a,content:r||""}}(e,w,s.handlers,s.handler),h.attr(o,"false").addClass("lity-loading lity-opened lity-"+v.handler).appendTo("body").focus().on("click","[data-lity-close]",(function(e){$(e.target).is("[data-lity-close]")&&w.close()})).trigger("lity:open",[w]),x=w,1===a.unshift(x)&&(r.addClass("lity-active"),n.on({resize:b,keydown:g})),$("body > *").not(x.element()).addClass("lity-hidden").each((function(){var e=$(this);void 0===e.data(l)&&e.data(l,e.attr(o)||null)})).attr(o,"true"),$.when(v.content).always((function(e){m=$(e).css("max-height",p()+"px"),h.find(".lity-loader").each((function(){var e=$(this);f(e).always((function(){e.remove()}))})),h.removeClass("lity-loading").find(".lity-content").empty().append(m),C=!0,m.trigger("lity:ready",[w])}))}function C(e,n,i){e.preventDefault?(e.preventDefault(),e=(i=$(this)).data("lity-target")||i.attr("href")||i.attr("src")):i=$(i);var r=new w(e,$.extend({},i.data("lity-options")||i.data("lity"),n),i,t.activeElement);if(!e.preventDefault)return r}return m.test=function(e){return c.test(e)},C.version="3.0.0-dev",C.options=$.proxy(y,C,d),C.handlers=$.proxy(y,C,d.handlers),C.current=x,C.iframe=h,$(t).on("click.lity","[data-lity]",C),C}));